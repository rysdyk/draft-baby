!function(){var t={init:function(){this.cacheDom(),this.getPlayers(),this.renderPlayers(),this.assignSortedPosition(),this.sortPlayers(),this.draftSettings(),this.setVariables(),this.addClick()},cacheDom:function(){this.table=document.getElementById("draftable-player-list"),this.tbody=this.table.getElementsByTagName("tbody"),this.team=document.getElementById("team"),this.teams=document.getElementById("teams"),this.draftPos=document.getElementById("draftPos"),this.settings=document.getElementById("draft-settings"),this.pickNumber=document.getElementById("pick-number"),this.draftProgress=document.getElementById("draft-progress"),this.draftedList=document.getElementById("drafted"),this.start=document.getElementById("startDraftButton")},getPlayers:function(){var t=new XMLHttpRequest;t.open("GET","lib/ffc_2017_6_23.json",!1),t.send(null),this.players=JSON.parse(t.responseText)},renderPlayers:function(){this.players.forEach(function(e){var s=document.createElement("tr");t.tbody[0].appendChild(s);for(var i in e)if("name"==i||"position"==i||"team"==i||"bye"==i){var n=document.createElement("td");n.appendChild(document.createTextNode(e[i])),s.appendChild(n)}})},assignSortedPosition:function(){this.players.forEach(function(e,s){var i,n,a=t.players.indexOf(e);s<25?(i=1.2*a+4,n=.7*a-4):s>=25&&s<51?(i=1.1*a,n=.8*a):s>=51&&s<100?(i=1.05*a,n=.9*a):(i=1.05*a,n=.9*a),n<0&&(n=0),sorted_pos=Math.random()*(i-n)+n,t.players[s].sorted_pos=sorted_pos})},sortPlayers:function(){this.players.sort(function(t,e){return t.sorted_pos-e.sorted_pos})},draftSettings:function(){this.teams.addEventListener("change",function(){var e=parseInt(t.teams.value);t.draftPos.innerHTML="";for(var s=1;s<=e;s++){var i=document.createElement("option");i.text=s,i.value=s,t.draftPos.add(i)}})},setVariables:function(){this.count=1,this.run="",this.picks=[],this.fullDraftedList=[]},addClick:function(){this.start.addEventListener("click",function(){t.startDraft()})},startDraft:function(){var e=parseInt(this.teams.value),s=parseInt(this.draftPos.value);t.fadeOut(this.settings),t.setPicks(e,s),t.computerPicks()},setPicks:function(t,e){for(var s=e;s<=this.players.length;s+=2*t)this.picks.push(s);for(var i=2*t-e+1;i<=this.players.length;i+=2*t)this.picks.push(i)},computerPicks:function(){if(this.picks.includes(this.count))t.userDraft();else{var e=this.players.shift();t.draftSelected(e),t.increaseCount(),this.run=setTimeout(function(){t.computerPicks()},750)}},increaseCount:function(){this.count++,this.pickNumber.innerHTML=this.count},userDraft:function(){clearTimeout(this.run),this.draftProgress.classList.add("eligible"),this.tbody[0].classList.add("active");var e=document.querySelector("tbody.active").childNodes;e.forEach(function(e){e.addEventListener("click",function(){if(t.tbody[0].classList.contains("active")){t.tbody[0].classList.remove("active"),t.draftProgress.classList.remove("eligible");for(var e=0;e<t.players.length;e++)if(t.players[e].name==this.childNodes[0].innerHTML){var s=t.players[e];t.players.splice(e,1),t.draftSelected(s),t.increaseCount();var i=document.createElement("li");t.team.appendChild(document.createTextNode(s.position+" "+s.name+" "+s.bye)),t.team.appendChild(i),setTimeout(function(){t.computerPicks()},750);break}}})})},draftSelected:function(e){this.fullDraftedList.push(e);var s=this.tbody[0].childNodes;s.forEach(function(s){var i=s.childNodes[0].innerText;e.name==i&&t.fadeOut(s)});var i=document.createElement("li");i.appendChild(document.createTextNode(this.count+". "+e.name)),this.draftedList.prepend(i)},fadeOut:function(t){t.classList.add("fadeOut"),setTimeout(function(){t.classList.add("hidden")},500)}};t.init()}();